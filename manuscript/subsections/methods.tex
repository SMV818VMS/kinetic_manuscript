%\addbibresource{/home/jorgsk/Dropbox/phdproject/bibtex/jorgsk.bib}
\subsection{Model of initial transcription}
Our model is based on a minimal scheme for initial transcription, containing
reactions for i) the nucleotide addition cycle (NAC), ii) backstepping (the
first unscrunching step), iii) promoter escape, and iv) unscrunching and
abortive RNA release (Figure \ref{fig:model_and_rates}A). We obtain the
reaction rates for all reactions except backstepping by varying these values
within certain bounds and then comparing model fit with experimental data (see
below). To identify the reaction rate of backstepping, we make use of an
additional information. We use the fact that the probability to backstep is
proportional to the abortive probability (AP) \cite{hsu_quantitative_1996}.
Therefore, given a rate constant for NAC, we may calculate the rate constant
of backstepping, $b$, in the following way:
\begin{equation*}
  b = \frac{\text{NAC}\cdot\text{AP}}{1-\text{AP}},
\end{equation*}
which reflects a kinetic competition between backstepping and the NAC at each
template position. Figure~\ref{fig:model_and_rates}B shows the initial
transcription kinetic scheme together with placeholder values for the
estimated rate constants. The rate of FL product synthesis upon promoter
escape is given by NAC/n where n is the number of basepairs from promoter
escape until runoff.

In this work we use APs calculated from initial transcription both in the
presence of GreB (+GreB) and in the absence of GreB (-GreB). When GreB is
present, backtracked complexes may be rescued by GreB stimulated cleavage of
the unaligned 3\ppp end of the transcript. Therefore, APs obtained in the
presence of GreB represent the probability to both backstep and to avoid
rescue by GreB until abortive RNA release. Here, we assume that GreB-mediated
cleavage and subsequent NACs are rapid steps compared to unscrunching, so that
the APs obtained in the presence of GreB may be used as effective backstepping
probabilities.

\subsection{Implementation and parameter estimation}
To solve the kinetic scheme we use the direct method for the stochastic
simulation algorithm \cite{gillespie_exact_1977} as implemented in the StocPY
software \cite{maarleveld_stochpy:_2013}. By using stochastic simulations, we
are able to simulate transcription to the level of single RNA polymerases to
resolve some of the stochasticity inherent with such low copy number
reactions. The use of stochastic simulations is required as we are comparing
model results to the distribution of time spent in abortive cycling prior to
promoter escape as reported by Revyakin et.\ al \cite{revyakin_abortive_2006}.
This experiment was performed using 100 single-RNAP transcription events
(Figure 4D in Revyakin et.\ al).

We estimate the rate constants of NAC, promoter escape, and unscrunching using
a two-step proceedure. In the first step, we perform Monte Carlo sampling of
50000 triplets of the three rate constants in the range 1 s$^{-1}$ to 25
s$^{-1}$, which we considered to be reasonable boundaries for rate constants
of all three reactions. For each triplet sample, we use the value for NAC to
obtain rate constants for backstepping (as illustrated in
Figure~\ref{fig:model_and_rates}B). We then use the sampled and calculated
rate constants to simulate initial transcription on N25 with 100 RNAPs to
find the cumulative distribution of time spent in abortive cycling, which is
compared to the measured values from Revaykin et.\ al
\cite{revyakin_abortive_2006} using the root mean squared distance metric. The
resulting fits are ranked by the metric distance, (lower is better), and we
calculate the weighted mean and weighted standard deviation of the top 1\%, or
500 samples, using the inverse of the metric distance as weights, normalized
so the closest fit has weight 1 and a fit with half the metric score of the
closest fit has weight 0.5. The standard deviation around each reaction rate
constants is then used as search-boundaries for the second step. In the second
step, we sample 50000 values in a gridded search within the weighted standard
deviation of each rate constant to obtain the fit of the model. The final rate
constants are calculated from the mean and standard deviation of the 1\% best
fits from the gridded search.

\begin{figure}
	\begin{center}
        \includegraphics{../illustrations/model_and_rates.pdf}
	\end{center}
    \caption{Kinetic model scheme and reaction rate constants. A) From the
    open complex (OC) transcription proceeds by nucleotide additions cycles
    from one initial transcribing complex (IC) to the next, where each IC is
    identified in subscript by the length of its nascent RNA. Initial
    transcription proceeds until the nascent RNA has reached the
    experimentally obtained maximum size of abortive transcript (MSAT)
    \cite{hsu_initial_2006}. For ICs with an 2nt RNA or longer, there is a
    competition between the nucleotide addition cycle (NAC) and backstepping.
    Backstepping leads to a backtracked state from which further backtracking
    and abortive RNA release occurs, returning RNAP to the open complex. From
    the open complex forward transcription may resume once more. B) Kinetic
    scheme containing placeholder values for the estimated rate constants for
    NAC, $x$, promoter escape, $y$, and unscrunching and abortive release ,$z$,
    as well as the rate constants of bakcstepping, $b_i(x)$.}
    \label{fig:model_and_rates}
\end{figure}

